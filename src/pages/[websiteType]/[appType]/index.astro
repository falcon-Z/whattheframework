---
import type { AppType, WebsiteType } from "../../../data/types";
import Main from "../../../layouts/Main.astro";
import StartOver from "../../../components/StartOver.astro";
import Validator from "../../../utils/Validator";
import FrameworkOptions from "../../../components/FrameworkOptions.astro";
import FrameworkSelector from "../../../utils/FrameworkSelector";
import { SupportingInfo } from "../../../data/supporting-info";
import { shuffle } from "../../../utils/tools";

const { params } = Astro;

if (!Validator.appType(params.appType)) {
  return Astro.redirect("/");
}

const options = FrameworkSelector({
  websiteType: params.websiteType,
  appType: params.appType,
});

const topPicks = shuffle(
  options.filter(
    (option) => option.appTypesInOrderOfPriority[0] === params.appType
  )
);

const otherPicks = shuffle(
  options.filter(
    (option) => option.appTypesInOrderOfPriority[0] !== params.appType
  )
);
---

<Main>
  <section class="mx-auto">
    <div
      class="py-16 px-4 mb-8 w-full bg-gradient-to-r from-gray-300 dark:from-gray-800 via-gray-400 dark:via-gray-700 to-gray-300 dark:to-gray-800"
    >
      <h1 class="text-3xl text-center mb-4">
        Your
        {SupportingInfo.websiteType[params.websiteType as WebsiteType].name}
        is most probably suited to a {
          SupportingInfo.appType[params.appType as AppType].name
        }
      </h1>
      <p class="text-base text-center first-letter:uppercase px-8 mb-4">
        {SupportingInfo.appType[params.appType as AppType].description}
      </p>
    </div>

    <div class="container w-11/12 mx-auto">
      <h2 class="text-xl font-bold text-center my-8">
        Top picks for {SupportingInfo.appType[params.appType as AppType].name}
        {SupportingInfo.websiteType[params.websiteType as WebsiteType].name}s
      </h2>
      <FrameworkOptions options={topPicks} allowFilter={true} />

      <h2 class="text-xl font-bold text-center my-8">
        Other frameworks that may also suit this type of website
      </h2>
      <FrameworkOptions options={otherPicks} />

      <div class="p-16 flex justify-center">
        <StartOver />
      </div>
    </div>
  </section>
</Main>
